{% extends 'management/base.html' %}
{% load static %} 
{% block page_title %}Create Route Plan{% endblock %}

{% block title %}Create Route Plan{% endblock title%}
{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <form method="post">
                {% csrf_token %}
                {{ form.date.label_tag }}
                {{ form.date }}
                {{ form.date.errors }}
                <br>
                {{ form.agent.label_tag }}
                {{ form.agent }}
                {{ form.agent.errors }}
                <br>
                {{ form.institution.label_tag }}
                {{ form.institution }}
                {{ form.institution.errors }}
                <br>
                {{ form.location.label_tag }}
                {{ form.location }}
                {{ form.location.errors }}
                <br>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        </div>
    </div>
</div>
<script>
    var ws_scheme = window.location.protocol === "https:" ? "wss" : "ws";
    var ws_path = ws_scheme + '://' + window.location.host + '/ws/notifications/';
    var socket = new WebSocket(ws_path);

    socket.onmessage = function(e) {
        var data = JSON.parse(e.data);
        if (data.type === 'notification') {
            // Handle the incoming notification
            var notificationContent = data.message;
            // Update your HTML to display the notification
            // (e.g., add a new list item to the existing list)
            // Example: Assuming you have a <ul> with the id "notification-list"
            var notificationList = document.getElementById('notification-list');
            var listItem = document.createElement('li');
            listItem.textContent = notificationContent;
            notificationList.appendChild(listItem);
        }
    };
</script>
{% endblock %}
